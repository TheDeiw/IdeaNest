# ‚úÖ –í–ò–ü–†–ê–í–õ–ï–ù–û! –ö–æ–Ω—Ñ–ª—ñ–∫—Ç –ø–∞–∫–µ—Ç—ñ–≤ —Ç–∞ Storage Rules

## –©–æ –±—É–ª–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. –í–µ—Ä—Å—ñ—è firebase_storage –æ–Ω–æ–≤–ª–µ–Ω–∞
- ‚ùå –ë—É–ª–æ: `firebase_storage: ^12.3.0`
- ‚úÖ –°—Ç–∞–ª–æ: `firebase_storage: ^13.0.4`

### 2. Storage Rules –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ
- ‚ùå –ë—É–ª–æ: `match /profile_photos/{userId}.jpg`
- ‚úÖ –°—Ç–∞–ª–æ: `match /profile_photos/{userId}`
- ‚ûï –î–æ–¥–∞–Ω–æ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é —Ç–∏–ø—É —Ñ–∞–π–ª—É
- ‚ûï –î–æ–¥–∞–Ω–æ –æ–±–º–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É (5MB)

---

## üöÄ –¢–µ–ø–µ—Ä –≤–∏–∫–æ–Ω–∞–π—Ç–µ —Ü—ñ –∫–æ–º–∞–Ω–¥–∏:

### –ö—Ä–æ–∫ 1: –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–∞–∫–µ—Ç–∏
```powershell
flutter pub get
```

**–û—á—ñ–∫—É—î—Ç—å—Å—è:**
```
Resolving dependencies...
+ firebase_storage 13.0.4
Got dependencies!
```

---

### –ö—Ä–æ–∫ 2: –û–Ω–æ–≤—ñ—Ç—å Storage Rules —É Firebase Console

**–ü–µ—Ä–µ–π–¥—ñ—Ç—å:**
https://console.firebase.google.com/project/ideanest-2026/storage/rules

**–í—Å—Ç–∞–≤—Ç–µ —Ü—ñ –ø—Ä–∞–≤–∏–ª–∞:**
```javascript
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    match /profile_photos/{userId} {
      allow read: if true;
      
      allow write: if request.auth != null 
                   && request.auth.uid == userId
                   && request.resource.contentType.matches('image/.*')
                   && request.resource.size < 5 * 1024 * 1024;
      
      allow delete: if request.auth != null && request.auth.uid == userId;
    }
  }
}
```

**–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Publish"**

---

### –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–æ–¥–∞—Ç–æ–∫
```powershell
flutter run
```

---

## ‚úÖ –©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—å —É –ø—Ä–∞–≤–∏–ª–∞—Ö:

### –°—Ç–∞—Ä—ñ –ø—Ä–∞–≤–∏–ª–∞ (–ù–ï –ø—Ä–∞—Ü—é–≤–∞–ª–∏):
```javascript
match /profile_photos/{userId}.jpg {  // ‚ùå .jpg –≤–∏–∫–ª–∏–∫–∞–ª–æ –ø–æ–º–∏–ª–∫—É
  allow write: if request.auth != null && request.auth.uid == userId;
}
```

### –ù–æ–≤—ñ –ø—Ä–∞–≤–∏–ª–∞ (–ø—Ä–∞—Ü—é—é—Ç—å):
```javascript
match /profile_photos/{userId} {  // ‚úÖ –ë–ï–ó —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
  allow write: if request.auth != null 
               && request.auth.uid == userId
               && request.resource.contentType.matches('image/.*')  // ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∏–ø—É
               && request.resource.size < 5 * 1024 * 1024;  // ‚úÖ –ú–∞–∫—Å–∏–º—É–º 5MB
}
```

---

## üìä –ß–æ–º—É —Ü–µ –≤–∞–∂–ª–∏–≤–æ:

1. **–ë–ï–ó `.jpg`** - Firebase Storage –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —É match path
2. **contentType.matches('image/.*')** - –¥–æ–∑–≤–æ–ª—è—î –≤—Å—ñ —Ñ–æ—Ä–º–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å (jpg, png, webp —Ç–æ—â–æ)
3. **size < 5MB** - –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏—Ö —Ñ–∞–π–ª—ñ–≤

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫—Ä–æ–∫—ñ–≤ –≤–∏—â–µ:

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–æ–¥–∞—Ç–æ–∫
2. –ó–∞–ª–æ–≥—ñ–Ω—å—Ç–µ—Å—å
3. Settings ‚Üí –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∞–≤–∞—Ç–∞—Ä
4. –í–∏–±–µ—Ä—ñ—Ç—å —Ñ–æ—Ç–æ
5. ‚úÖ –ú–∞—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏—Å—å –±–µ–∑ –ø–æ–º–∏–ª–æ–∫

---

## üìû –Ø–∫—â–æ –¥–æ—Å—ñ –ø–æ–º–∏–ª–∫–∞

### –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ `flutter pub get`:
```bash
flutter clean
flutter pub get
```

### –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó –ø—Ä–∞–≤–∏–ª:
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ —Å–∫–æ–ø—ñ—é–≤–∞–ª–∏ –í–°–Ü –ø—Ä–∞–≤–∏–ª–∞
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –Ω–µ–º–∞—î `.jpg` —É —Ä—è–¥–∫—É match
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ—ñ–≥—É—Ä–Ω—ñ –¥—É–∂–∫–∏ `{ }`

### –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Ñ–æ—Ç–æ:
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –ø—Ä–∞–≤–∏–ª–∞ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–ª–æ–≥—ñ–Ω–µ–Ω–∏–π
- –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –ª–æ–≥–∏: `flutter run --verbose`

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä –≤—Å–µ –º–∞—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ! üéâ

